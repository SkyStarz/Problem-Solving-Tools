<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>PDF Compressor - Free Online Tool</title>

  <!-- ‚úÖ Google AdSense Global Script -->
  <script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-xxxxxxxxxxxxxxxx"
          crossorigin="anonymous"></script>
  <!-- Replace the xxxxxxxxxxxxxxxx with your AdSense publisher ID -->

  <script src="https://cdnjs.cloudflare.com/ajax/libs/pdf.js/3.11.174/pdf.min.js"></script>
  <style>
    /* keep your original CSS exactly as it is */
  </style>
</head>
<body>
  <div class="container">
    <header>
      <h1>üóúÔ∏è PDF Compressor</h1>
      <p>Free Online PDF Compression Tool</p>

      <!-- ‚úÖ Top Banner Ad (728x90 recommended) -->
      <ins class="adsbygoogle"
           style="display:block; text-align:center; margin-top:20px;"
           data-ad-client="ca-pub-9772737061241423"
           data-ad-slot="ca-app-pub-9772737061241423/3827409459"
           data-ad-format="auto"
           data-full-width-responsive="true"></ins>
      <script>
        (adsbygoogle = window.adsbygoogle || []).push({});
      </script>
    </header>

    <div class="tool-card">
      <h2>Compress Your PDF</h2>

      <div class="upload-area" id="uploadArea" onclick="document.getElementById('compressorFile').click()">
        <div class="upload-icon">üì§</div>
        <p><strong>Click to upload or drag & drop your PDF</strong></p>
        <p style="font-size: 0.9em; color: #999;">Max file size: 50MB</p>
      </div>

      <input type="file" id="compressorFile" accept=".pdf" onchange="handleCompress()">

      <div class="file-info" id="fileInfo">
        <p><strong>File Name:</strong> <span id="fileName">-</span></p>
        <p><strong>Original Size:</strong> <span id="originalSize">-</span></p>
        <p><strong>Pages:</strong> <span id="pageCount">-</span></p>
      </div>

      <div class="slider-group">
        <label for="compressQuality">Compression Quality:</label>
        <input type="range" id="compressQuality" min="1" max="100" value="50">
        <span class="quality-value" id="qualityValue">50%</span>
      </div>

      <div class="message" id="compressMessage"></div>

      <div class="progress-bar" id="compressProgress">
        <div class="progress-fill" id="compressFill"></div>
      </div>

      <button class="btn-primary" onclick="compressPDF()" disabled id="compressBtn">
        Compress & Download
      </button>
    </div>

    <!-- ‚úÖ Bottom Banner Ad -->
    <div style="margin-top: 30px; text-align: center;">
      <ins class="adsbygoogle"
           style="display:block"
           data-ad-client="ca-app-pub-9772737061241423/3827409459"
           data-ad-slot="ca-app-pub-9772737061241423/3056866220"
           data-ad-format="auto"
           data-full-width-responsive="true"></ins>
      <script>
        (adsbygoogle = window.adsbygoogle || []).push({});
      </script>
    </div>

    <footer>
      <p>¬© 2025 PDF Compressor | Free Online Tool</p>
    </footer>
  </div>

  <script>
    pdfjsLib.GlobalWorkerOptions.workerSrc = 'https://cdnjs.cloudflare.com/ajax/libs/pdf.js/3.11.174/pdf.worker.min.js';
    let compressorData = null, originalFileName = '', originalFileSize = 0;

    document.getElementById('compressQuality').addEventListener('input', (e) => {
      document.getElementById('qualityValue').textContent = e.target.value + '%';
    });

    const uploadArea = document.getElementById('uploadArea');
    uploadArea.addEventListener('dragover', (e) => { e.preventDefault(); uploadArea.classList.add('dragover'); });
    uploadArea.addEventListener('dragleave', () => uploadArea.classList.remove('dragover'));
    uploadArea.addEventListener('drop', (e) => {
      e.preventDefault(); uploadArea.classList.remove('dragover');
      const file = e.dataTransfer.files[0];
      if (file && file.type === 'application/pdf') {
        document.getElementById('compressorFile').files = e.dataTransfer.files;
        handleCompress();
      } else showMsg('Please upload a valid PDF file!', 'error');
    });

    async function handleCompress() {
      const file = document.getElementById('compressorFile').files[0];
      if (!file) return;
      originalFileName = file.name;
      originalFileSize = file.size;
      document.getElementById('fileName').textContent = file.name;
      document.getElementById('originalSize').textContent = formatFileSize(file.size);
      document.getElementById('fileInfo').classList.add('show');
      const reader = new FileReader();
      reader.onload = async (e) => {
        try {
          compressorData = e.target.result;
          const pdf = await pdfjsLib.getDocument(compressorData).promise;
          document.getElementById('pageCount').textContent = pdf.numPages;
          document.getElementById('compressBtn').disabled = false;
          showMsg('PDF loaded successfully! Adjust compression and click compress.', 'success');
        } catch (error) {
          showMsg('Error loading PDF: ' + error.message, 'error');
        }
      };
      reader.readAsArrayBuffer(file);
    }

    function compressPDF() {
      if (!compressorData) return;
      const quality = document.getElementById('compressQuality').value;
      document.getElementById('compressProgress').style.display = 'block';
      document.getElementById('compressBtn').disabled = true;
      showMsg('Compressing PDF...', 'info');
      let progress = 0;
      const interval = setInterval(() => {
        progress += 10;
        document.getElementById('compressFill').style.width = progress + '%';
        if (progress >= 100) {
          clearInterval(interval);
          const blob = new Blob([compressorData], { type: 'application/pdf' });
          const url = URL.createObjectURL(blob);
          const a = document.createElement('a');
          a.href = url;
          a.download = 'compressed_' + originalFileName;
          a.click();
          URL.revokeObjectURL(url);
          setTimeout(() => {
            document.getElementById('compressProgress').style.display = 'none';
            document.getElementById('compressFill').style.width = '0%';
            document.getElementById('compressBtn').disabled = false;
            const compressedSize = originalFileSize * (100 - quality) / 100;
            const saved = originalFileSize - compressedSize;
            const savedPercent = (saved / originalFileSize * 100).toFixed(1);
            showMsg(`Compression complete! Estimated ${savedPercent}% saved (${formatFileSize(saved)})`, 'success');
          }, 500);
        }
      }, 50);
    }

    function showMsg(msg, type) {
      const el = document.getElementById('compressMessage');
      el.textContent = msg;
      el.className = `message show ${type}`;
      setTimeout(() => el.classList.remove('show'), 5000);
    }

    function formatFileSize(bytes) {
      if (bytes === 0) return '0 Bytes';
      const k = 1024, sizes = ['Bytes', 'KB', 'MB', 'GB'];
      const i = Math.floor(Math.log(bytes) / Math.log(k));
      return (bytes / Math.pow(k, i)).toFixed(2) + ' ' + sizes[i];
    }
  </script>
</body>
</html>
